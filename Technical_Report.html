<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Ali Ahmed, Andreina Arias, Kaylie Evans, Naomi Buell, and Zaneta Paulusova">
<meta name="dcterms.date" content="2025-04-29">

<title>DATA 624 Project 2: Technical Report</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Technical_Report_files/libs/clipboard/clipboard.min.js"></script>
<script src="Technical_Report_files/libs/quarto-html/quarto.js"></script>
<script src="Technical_Report_files/libs/quarto-html/popper.min.js"></script>
<script src="Technical_Report_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Technical_Report_files/libs/quarto-html/anchor.min.js"></script>
<link href="Technical_Report_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Technical_Report_files/libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Technical_Report_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Technical_Report_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Technical_Report_files/libs/bootstrap/bootstrap-8a79a254b8e706d3c925cde0a310d4f0.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">DATA 624 Project 2: Technical Report</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Ali Ahmed, Andreina Arias, Kaylie Evans, Naomi Buell, and Zaneta Paulusova </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">April 29, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="instructions" class="level2">
<h2 class="anchored" data-anchor-id="instructions">Instructions</h2>
<p><em>This is role playing. I am your new boss. I am in charge of production at ABC Beverage and you are a team of data scientists reporting to me. My leadership has told me that new regulations are requiring us to understand our manufacturing process, the predictive factors and be able to report to them our predictive model of PH.</em></p>
<p><em>Please use the historical data set I am providing. Build and report the factors in BOTH a technical and non-technical report. I like to use Word and Excel. Please provide your non-technical report in a business friendly readable document and your predictions in an Excel readable format. The technical report should show clearly the models you tested and how you selected your final approach.</em></p>
<p><em>Please submit both Rpubs links and .rmd files or other readable formats for technical and non-technical reports. Also submit the excel file showing the prediction of your models for pH.</em></p>
</section>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>In this technical report, we will analyze the manufacturing process of ABC Beverage to understand the factors that influence the pH level of the product. We will build predictive models to forecast pH levels based on various predictors in the dataset. The goal is to provide insights into the manufacturing process and to create a model that can be used for future predictions.</p>
</section>
<section id="setup" class="level2">
<h2 class="anchored" data-anchor-id="setup">Setup</h2>
<p>We will use the following packages for data analysis, modeling, and visualization.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.setenv</span>(<span class="at">JAVA_HOME =</span> <span class="st">"C:/Program Files/TreeAgePro/jre18162"</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DataExplorer)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.1     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.1
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fpp3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Registered S3 method overwritten by 'tsibble':
  method               from 
  as_tibble.grouped_df dplyr
── Attaching packages ──────────────────────────────────────────── fpp3 1.0.1 ──
✔ tsibble     1.1.6     ✔ feasts      0.4.1
✔ tsibbledata 0.4.1     ✔ fable       0.3.4
── Conflicts ───────────────────────────────────────────────── fpp3_conflicts ──
✖ lubridate::date()    masks base::date()
✖ dplyr::filter()      masks stats::filter()
✖ tsibble::intersect() masks base::intersect()
✖ tsibble::interval()  masks lubridate::interval()
✖ dplyr::lag()         masks stats::lag()
✖ tsibble::setdiff()   masks base::setdiff()
✖ tsibble::union()     masks base::union()</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: lattice

Attaching package: 'caret'

The following objects are masked from 'package:fabletools':

    MAE, RMSE

The following object is masked from 'package:purrr':

    lift</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(skimr)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(doParallel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: foreach

Attaching package: 'foreach'

The following objects are masked from 'package:purrr':

    accumulate, when

Loading required package: iterators
Loading required package: parallel</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RWeka)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rpart)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>corrplot 0.95 loaded</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(openxlsx)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mice)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'mice'

The following object is masked from 'package:stats':

    filter

The following objects are masked from 'package:base':

    cbind, rbind</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'janitor'

The following objects are masked from 'package:stats':

    chisq.test, fisher.test</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We will also set the seed for reproducibility.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Since these models take a long time to train, we’ll utilize the <code>doParallel</code> package for speed.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>cluster <span class="ot">&lt;-</span> <span class="fu">makeCluster</span>(</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">detectCores</span>() <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="fu">registerDoParallel</span>(</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    cluster</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="load-data" class="level2">
<h2 class="anchored" data-anchor-id="load-data">Load data</h2>
<p>First, we load the data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>StudentData <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"StudentData.xlsx"</span>) <span class="co"># Training data</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>StudentEvaluation <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"StudentEvaluation.xlsx"</span>) <span class="co"># Test data</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="tidy-data-and-transformation" class="level2">
<h2 class="anchored" data-anchor-id="tidy-data-and-transformation">Tidy Data and Transformation</h2>
<p>In this section, we mutate variable types (e.g., convert character column <code>Brand Code</code> to factor, numeric, etc., so we can use this to forecast data) and impute missing data where needed. We also check correlation, removing features over a threshold to avoid multicollinearity, and remove near zero variance predictors with <code>nearZeroVar()</code>.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>tibble [2,571 × 33] (S3: tbl_df/tbl/data.frame)
 $ Brand Code       : chr [1:2571] "B" "A" "B" "A" ...
 $ Carb Volume      : num [1:2571] 5.34 5.43 5.29 5.44 5.49 ...
 $ Fill Ounces      : num [1:2571] 24 24 24.1 24 24.3 ...
 $ PC Volume        : num [1:2571] 0.263 0.239 0.263 0.293 0.111 ...
 $ Carb Pressure    : num [1:2571] 68.2 68.4 70.8 63 67.2 66.6 64.2 67.6 64.2 72 ...
 $ Carb Temp        : num [1:2571] 141 140 145 133 137 ...
 $ PSC              : num [1:2571] 0.104 0.124 0.09 NA 0.026 0.09 0.128 0.154 0.132 0.014 ...
 $ PSC Fill         : num [1:2571] 0.26 0.22 0.34 0.42 0.16 ...
 $ PSC CO2          : num [1:2571] 0.04 0.04 0.16 0.04 0.12 ...
 $ Mnf Flow         : num [1:2571] -100 -100 -100 -100 -100 -100 -100 -100 -100 -100 ...
 $ Carb Pressure1   : num [1:2571] 119 122 120 115 118 ...
 $ Fill Pressure    : num [1:2571] 46 46 46 46.4 45.8 45.6 51.8 46.8 46 45.2 ...
 $ Hyd Pressure1    : num [1:2571] 0 0 0 0 0 0 0 0 0 0 ...
 $ Hyd Pressure2    : num [1:2571] NA NA NA 0 0 0 0 0 0 0 ...
 $ Hyd Pressure3    : num [1:2571] NA NA NA 0 0 0 0 0 0 0 ...
 $ Hyd Pressure4    : num [1:2571] 118 106 82 92 92 116 124 132 90 108 ...
 $ Filler Level     : num [1:2571] 121 119 120 118 119 ...
 $ Filler Speed     : num [1:2571] 4002 3986 4020 4012 4010 ...
 $ Temperature      : num [1:2571] 66 67.6 67 65.6 65.6 66.2 65.8 65.2 65.4 66.6 ...
 $ Usage cont       : num [1:2571] 16.2 19.9 17.8 17.4 17.7 ...
 $ Carb Flow        : num [1:2571] 2932 3144 2914 3062 3054 ...
 $ Density          : num [1:2571] 0.88 0.92 1.58 1.54 1.54 1.52 0.84 0.84 0.9 0.9 ...
 $ MFR              : num [1:2571] 725 727 735 731 723 ...
 $ Balling          : num [1:2571] 1.4 1.5 3.14 3.04 3.04 ...
 $ Pressure Vacuum  : num [1:2571] -4 -4 -3.8 -4.4 -4.4 -4.4 -4.4 -4.4 -4.4 -4.4 ...
 $ PH               : num [1:2571] 8.36 8.26 8.94 8.24 8.26 8.32 8.4 8.38 8.38 8.5 ...
 $ Oxygen Filler    : num [1:2571] 0.022 0.026 0.024 0.03 0.03 0.024 0.066 0.046 0.064 0.022 ...
 $ Bowl Setpoint    : num [1:2571] 120 120 120 120 120 120 120 120 120 120 ...
 $ Pressure Setpoint: num [1:2571] 46.4 46.8 46.6 46 46 46 46 46 46 46 ...
 $ Air Pressurer    : num [1:2571] 143 143 142 146 146 ...
 $ Alch Rel         : num [1:2571] 6.58 6.56 7.66 7.14 7.14 7.16 6.54 6.52 6.52 6.54 ...
 $ Carb Rel         : num [1:2571] 5.32 5.3 5.84 5.42 5.44 5.44 5.38 5.34 5.34 5.34 ...
 $ Balling Lvl      : num [1:2571] 1.48 1.56 3.28 3.04 3.04 3.02 1.44 1.44 1.44 1.38 ...</code></pre>
</div>
</div>
<p>We impute missing data below. It is best to impute data when missing data is it less than 5%, brand code rounds up to 5% which is why the missing data for brand code will be removed rather.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>       Brand Code       Carb Volume       Fill Ounces         PC Volume 
       4.66744457        0.38895371        1.47802412        1.51691949 
    Carb Pressure         Carb Temp               PSC          PSC Fill 
       1.05017503        1.01127966        1.28354726        0.89459354 
          PSC CO2          Mnf Flow    Carb Pressure1     Fill Pressure 
       1.51691949        0.07779074        1.24465189        0.85569817 
    Hyd Pressure1     Hyd Pressure2     Hyd Pressure3     Hyd Pressure4 
       0.42784909        0.58343057        0.58343057        1.16686114 
     Filler Level      Filler Speed       Temperature        Usage cont 
       0.77790743        2.21703617        0.54453520        0.19447686 
        Carb Flow           Density               MFR           Balling 
       0.07779074        0.03889537        8.24581875        0.03889537 
  Pressure Vacuum                PH     Oxygen Filler     Bowl Setpoint 
       0.00000000        0.15558149        0.46674446        0.07779074 
Pressure Setpoint     Air Pressurer          Alch Rel          Carb Rel 
       0.46674446        0.00000000        0.35005834        0.38895371 
      Balling Lvl 
       0.03889537 </code></pre>
</div>
</div>
<p>The missing data for brand code were removed as imputation wouldn’t appripiate and leaving it missing would cause misleading results in our analysis. For the missing data the MICE function was used to impute missing data that are numerical.</p>
<p>Removed near zero variance variables.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>       Brand Code       Carb Volume       Fill Ounces         PC Volume 
                0                 0                 0                 0 
    Carb Pressure         Carb Temp               PSC          PSC Fill 
                0                 0                 0                 0 
          PSC CO2          Mnf Flow    Carb Pressure1     Fill Pressure 
                0                 0                 0                 0 
    Hyd Pressure2     Hyd Pressure3     Hyd Pressure4      Filler Level 
                0                 0                 0                 0 
     Filler Speed       Temperature        Usage cont         Carb Flow 
                0                 0                 0                 0 
          Density               MFR           Balling   Pressure Vacuum 
                0                 0                 0                 0 
               PH     Oxygen Filler     Bowl Setpoint Pressure Setpoint 
                0                 0                 0                 0 
    Air Pressurer          Alch Rel          Carb Rel       Balling Lvl 
                0                 0                 0                 0 </code></pre>
</div>
</div>
<p>Now there is no missing data and <code>hyd_pressure1</code> was removed as it was the variable with a variance near zero.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>cor_matrix <span class="ot">&lt;-</span> StudentData <span class="sc">|&gt;</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select_if</span>(is.numeric) <span class="sc">|&gt;</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cor</span>()</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Set threshold for correlation</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>threshold <span class="ot">&lt;-</span> <span class="fl">0.9</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Removed columns with correlation over threshold</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>high_cor_indices <span class="ot">&lt;-</span> <span class="fu">findCorrelation</span>(cor_matrix, <span class="at">cutoff =</span> threshold)</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Removed those columns from StudentData</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>StudentData <span class="ot">&lt;-</span> StudentData[, <span class="sc">-</span>high_cor_indices]</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Removed hyd_pressure2, hyd_presure4, filler_level, carb_flow , mfr, air_pressure</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>cor_matrix2 <span class="ot">&lt;-</span> StudentData <span class="sc">|&gt;</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select_if</span>(is.numeric) <span class="sc">|&gt;</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cor</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Correlation Plot</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>    cor_matrix2,</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"color"</span>,</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">"upper"</span>,</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">tl.col =</span> <span class="st">"black"</span>,</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">tl.cex =</span> .<span class="dv">8</span>,</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">addCoef.col =</span> <span class="st">"black"</span>,</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">number.cex =</span> .<span class="dv">5</span>,</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">diag =</span> <span class="cn">FALSE</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Technical_Report_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># missing data in StudentEvaluation</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>Missing2 <span class="ot">&lt;-</span> <span class="fu">colSums</span>(<span class="fu">is.na</span>(StudentEvaluation))</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(Missing2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       Brand Code       Carb Volume       Fill Ounces         PC Volume 
                8                 1                 6                 4 
    Carb Pressure         Carb Temp               PSC          PSC Fill 
                0                 1                 5                 3 
          PSC CO2          Mnf Flow    Carb Pressure1     Fill Pressure 
                5                 0                 4                 2 
    Hyd Pressure1     Hyd Pressure2     Hyd Pressure3     Hyd Pressure4 
                0                 1                 1                 4 
     Filler Level      Filler Speed       Temperature        Usage cont 
                2                10                 2                 2 
        Carb Flow           Density               MFR           Balling 
                0                 1                31                 1 
  Pressure Vacuum                PH     Oxygen Filler     Bowl Setpoint 
                1               267                 3                 1 
Pressure Setpoint     Air Pressurer          Alch Rel          Carb Rel 
                2                 1                 3                 2 
      Balling Lvl 
                0 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>StudentEvaluation <span class="ot">&lt;-</span> <span class="fu">mice</span>(</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>    StudentEvaluation,</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"pmm"</span>,</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">m =</span> <span class="dv">5</span>,</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">maxit =</span> <span class="dv">5</span>,</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">seed =</span> <span class="dv">10</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">complete</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 iter imp variable
  1   1  Carb Volume  Fill Ounces  PC Volume  Carb Temp  PSC  PSC Fill  PSC CO2  Carb Pressure1  Fill Pressure  Hyd Pressure2  Hyd Pressure3  Hyd Pressure4  Filler Level  Filler Speed  Temperature  Usage cont  Density  MFR  Balling  Pressure Vacuum  Oxygen Filler  Bowl Setpoint  Pressure Setpoint  Air Pressurer  Alch Rel  Carb Rel
  1   2  Carb Volume  Fill Ounces  PC Volume  Carb Temp  PSC  PSC Fill  PSC CO2  Carb Pressure1  Fill Pressure  Hyd Pressure2  Hyd Pressure3  Hyd Pressure4  Filler Level  Filler Speed  Temperature  Usage cont  Density  MFR  Balling  Pressure Vacuum  Oxygen Filler  Bowl Setpoint  Pressure Setpoint  Air Pressurer  Alch Rel  Carb Rel
  1   3  Carb Volume  Fill Ounces  PC Volume  Carb Temp  PSC  PSC Fill  PSC CO2  Carb Pressure1  Fill Pressure  Hyd Pressure2  Hyd Pressure3  Hyd Pressure4  Filler Level  Filler Speed  Temperature  Usage cont  Density  MFR  Balling  Pressure Vacuum  Oxygen Filler  Bowl Setpoint  Pressure Setpoint  Air Pressurer  Alch Rel  Carb Rel
  1   4  Carb Volume  Fill Ounces  PC Volume  Carb Temp  PSC  PSC Fill  PSC CO2  Carb Pressure1  Fill Pressure  Hyd Pressure2  Hyd Pressure3  Hyd Pressure4  Filler Level  Filler Speed  Temperature  Usage cont  Density  MFR  Balling  Pressure Vacuum  Oxygen Filler  Bowl Setpoint  Pressure Setpoint  Air Pressurer  Alch Rel  Carb Rel
  1   5  Carb Volume  Fill Ounces  PC Volume  Carb Temp  PSC  PSC Fill  PSC CO2  Carb Pressure1  Fill Pressure  Hyd Pressure2  Hyd Pressure3  Hyd Pressure4  Filler Level  Filler Speed  Temperature  Usage cont  Density  MFR  Balling  Pressure Vacuum  Oxygen Filler  Bowl Setpoint  Pressure Setpoint  Air Pressurer  Alch Rel  Carb Rel
  2   1  Carb Volume  Fill Ounces  PC Volume  Carb Temp  PSC  PSC Fill  PSC CO2  Carb Pressure1  Fill Pressure  Hyd Pressure2  Hyd Pressure3  Hyd Pressure4  Filler Level  Filler Speed  Temperature  Usage cont  Density  MFR  Balling  Pressure Vacuum  Oxygen Filler  Bowl Setpoint  Pressure Setpoint  Air Pressurer  Alch Rel  Carb Rel
  2   2  Carb Volume  Fill Ounces  PC Volume  Carb Temp  PSC  PSC Fill  PSC CO2  Carb Pressure1  Fill Pressure  Hyd Pressure2  Hyd Pressure3  Hyd Pressure4  Filler Level  Filler Speed  Temperature  Usage cont  Density  MFR  Balling  Pressure Vacuum  Oxygen Filler  Bowl Setpoint  Pressure Setpoint  Air Pressurer  Alch Rel  Carb Rel
  2   3  Carb Volume  Fill Ounces  PC Volume  Carb Temp  PSC  PSC Fill  PSC CO2  Carb Pressure1  Fill Pressure  Hyd Pressure2  Hyd Pressure3  Hyd Pressure4  Filler Level  Filler Speed  Temperature  Usage cont  Density  MFR  Balling  Pressure Vacuum  Oxygen Filler  Bowl Setpoint  Pressure Setpoint  Air Pressurer  Alch Rel  Carb Rel
  2   4  Carb Volume  Fill Ounces  PC Volume  Carb Temp  PSC  PSC Fill  PSC CO2  Carb Pressure1  Fill Pressure  Hyd Pressure2  Hyd Pressure3  Hyd Pressure4  Filler Level  Filler Speed  Temperature  Usage cont  Density  MFR  Balling  Pressure Vacuum  Oxygen Filler  Bowl Setpoint  Pressure Setpoint  Air Pressurer  Alch Rel  Carb Rel
  2   5  Carb Volume  Fill Ounces  PC Volume  Carb Temp  PSC  PSC Fill  PSC CO2  Carb Pressure1  Fill Pressure  Hyd Pressure2  Hyd Pressure3  Hyd Pressure4  Filler Level  Filler Speed  Temperature  Usage cont  Density  MFR  Balling  Pressure Vacuum  Oxygen Filler  Bowl Setpoint  Pressure Setpoint  Air Pressurer  Alch Rel  Carb Rel
  3   1  Carb Volume  Fill Ounces  PC Volume  Carb Temp  PSC  PSC Fill  PSC CO2  Carb Pressure1  Fill Pressure  Hyd Pressure2  Hyd Pressure3  Hyd Pressure4  Filler Level  Filler Speed  Temperature  Usage cont  Density  MFR  Balling  Pressure Vacuum  Oxygen Filler  Bowl Setpoint  Pressure Setpoint  Air Pressurer  Alch Rel  Carb Rel
  3   2  Carb Volume  Fill Ounces  PC Volume  Carb Temp  PSC  PSC Fill  PSC CO2  Carb Pressure1  Fill Pressure  Hyd Pressure2  Hyd Pressure3  Hyd Pressure4  Filler Level  Filler Speed  Temperature  Usage cont  Density  MFR  Balling  Pressure Vacuum  Oxygen Filler  Bowl Setpoint  Pressure Setpoint  Air Pressurer  Alch Rel  Carb Rel
  3   3  Carb Volume  Fill Ounces  PC Volume  Carb Temp  PSC  PSC Fill  PSC CO2  Carb Pressure1  Fill Pressure  Hyd Pressure2  Hyd Pressure3  Hyd Pressure4  Filler Level  Filler Speed  Temperature  Usage cont  Density  MFR  Balling  Pressure Vacuum  Oxygen Filler  Bowl Setpoint  Pressure Setpoint  Air Pressurer  Alch Rel  Carb Rel
  3   4  Carb Volume  Fill Ounces  PC Volume  Carb Temp  PSC  PSC Fill  PSC CO2  Carb Pressure1  Fill Pressure  Hyd Pressure2  Hyd Pressure3  Hyd Pressure4  Filler Level  Filler Speed  Temperature  Usage cont  Density  MFR  Balling  Pressure Vacuum  Oxygen Filler  Bowl Setpoint  Pressure Setpoint  Air Pressurer  Alch Rel  Carb Rel
  3   5  Carb Volume  Fill Ounces  PC Volume  Carb Temp  PSC  PSC Fill  PSC CO2  Carb Pressure1  Fill Pressure  Hyd Pressure2  Hyd Pressure3  Hyd Pressure4  Filler Level  Filler Speed  Temperature  Usage cont  Density  MFR  Balling  Pressure Vacuum  Oxygen Filler  Bowl Setpoint  Pressure Setpoint  Air Pressurer  Alch Rel  Carb Rel
  4   1  Carb Volume  Fill Ounces  PC Volume  Carb Temp  PSC  PSC Fill  PSC CO2  Carb Pressure1  Fill Pressure  Hyd Pressure2  Hyd Pressure3  Hyd Pressure4  Filler Level  Filler Speed  Temperature  Usage cont  Density  MFR  Balling  Pressure Vacuum  Oxygen Filler  Bowl Setpoint  Pressure Setpoint  Air Pressurer  Alch Rel  Carb Rel
  4   2  Carb Volume  Fill Ounces  PC Volume  Carb Temp  PSC  PSC Fill  PSC CO2  Carb Pressure1  Fill Pressure  Hyd Pressure2  Hyd Pressure3  Hyd Pressure4  Filler Level  Filler Speed  Temperature  Usage cont  Density  MFR  Balling  Pressure Vacuum  Oxygen Filler  Bowl Setpoint  Pressure Setpoint  Air Pressurer  Alch Rel  Carb Rel
  4   3  Carb Volume  Fill Ounces  PC Volume  Carb Temp  PSC  PSC Fill  PSC CO2  Carb Pressure1  Fill Pressure  Hyd Pressure2  Hyd Pressure3  Hyd Pressure4  Filler Level  Filler Speed  Temperature  Usage cont  Density  MFR  Balling  Pressure Vacuum  Oxygen Filler  Bowl Setpoint  Pressure Setpoint  Air Pressurer  Alch Rel  Carb Rel
  4   4  Carb Volume  Fill Ounces  PC Volume  Carb Temp  PSC  PSC Fill  PSC CO2  Carb Pressure1  Fill Pressure  Hyd Pressure2  Hyd Pressure3  Hyd Pressure4  Filler Level  Filler Speed  Temperature  Usage cont  Density  MFR  Balling  Pressure Vacuum  Oxygen Filler  Bowl Setpoint  Pressure Setpoint  Air Pressurer  Alch Rel  Carb Rel
  4   5  Carb Volume  Fill Ounces  PC Volume  Carb Temp  PSC  PSC Fill  PSC CO2  Carb Pressure1  Fill Pressure  Hyd Pressure2  Hyd Pressure3  Hyd Pressure4  Filler Level  Filler Speed  Temperature  Usage cont  Density  MFR  Balling  Pressure Vacuum  Oxygen Filler  Bowl Setpoint  Pressure Setpoint  Air Pressurer  Alch Rel  Carb Rel
  5   1  Carb Volume  Fill Ounces  PC Volume  Carb Temp  PSC  PSC Fill  PSC CO2  Carb Pressure1  Fill Pressure  Hyd Pressure2  Hyd Pressure3  Hyd Pressure4  Filler Level  Filler Speed  Temperature  Usage cont  Density  MFR  Balling  Pressure Vacuum  Oxygen Filler  Bowl Setpoint  Pressure Setpoint  Air Pressurer  Alch Rel  Carb Rel
  5   2  Carb Volume  Fill Ounces  PC Volume  Carb Temp  PSC  PSC Fill  PSC CO2  Carb Pressure1  Fill Pressure  Hyd Pressure2  Hyd Pressure3  Hyd Pressure4  Filler Level  Filler Speed  Temperature  Usage cont  Density  MFR  Balling  Pressure Vacuum  Oxygen Filler  Bowl Setpoint  Pressure Setpoint  Air Pressurer  Alch Rel  Carb Rel
  5   3  Carb Volume  Fill Ounces  PC Volume  Carb Temp  PSC  PSC Fill  PSC CO2  Carb Pressure1  Fill Pressure  Hyd Pressure2  Hyd Pressure3  Hyd Pressure4  Filler Level  Filler Speed  Temperature  Usage cont  Density  MFR  Balling  Pressure Vacuum  Oxygen Filler  Bowl Setpoint  Pressure Setpoint  Air Pressurer  Alch Rel  Carb Rel
  5   4  Carb Volume  Fill Ounces  PC Volume  Carb Temp  PSC  PSC Fill  PSC CO2  Carb Pressure1  Fill Pressure  Hyd Pressure2  Hyd Pressure3  Hyd Pressure4  Filler Level  Filler Speed  Temperature  Usage cont  Density  MFR  Balling  Pressure Vacuum  Oxygen Filler  Bowl Setpoint  Pressure Setpoint  Air Pressurer  Alch Rel  Carb Rel
  5   5  Carb Volume  Fill Ounces  PC Volume  Carb Temp  PSC  PSC Fill  PSC CO2  Carb Pressure1  Fill Pressure  Hyd Pressure2  Hyd Pressure3  Hyd Pressure4  Filler Level  Filler Speed  Temperature  Usage cont  Density  MFR  Balling  Pressure Vacuum  Oxygen Filler  Bowl Setpoint  Pressure Setpoint  Air Pressurer  Alch Rel  Carb Rel</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Number of logged events: 2</code></pre>
</div>
</div>
<p>The imputation left <code>pH</code> and <code>brand_code</code> columns untouched.</p>
<p>Lastly, we change all variable types to numeric.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>StudentData <span class="ot">&lt;-</span> StudentData[, <span class="fu">sapply</span>(</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>    StudentData,</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>    is.numeric</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a> )]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="exploratory-data-analysis" class="level2">
<h2 class="anchored" data-anchor-id="exploratory-data-analysis">Exploratory Data Analysis</h2>
<p>We browse the data below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>StudentData <span class="sc">|&gt;</span> <span class="fu">skim</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Data summary</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">Name</td>
<td style="text-align: left;">StudentData</td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of rows</td>
<td style="text-align: left;">2451</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of columns</td>
<td style="text-align: left;">25</td>
</tr>
<tr class="even">
<td style="text-align: left;">_______________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Column type frequency:</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">25</td>
</tr>
<tr class="odd">
<td style="text-align: left;">________________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Group variables</td>
<td style="text-align: left;">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 17%">
<col style="width: 9%">
<col style="width: 13%">
<col style="width: 7%">
<col style="width: 6%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">p0</th>
<th style="text-align: right;">p25</th>
<th style="text-align: right;">p50</th>
<th style="text-align: right;">p75</th>
<th style="text-align: right;">p100</th>
<th style="text-align: left;">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Carb Volume</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5.37</td>
<td style="text-align: right;">0.11</td>
<td style="text-align: right;">5.04</td>
<td style="text-align: right;">5.29</td>
<td style="text-align: right;">5.35</td>
<td style="text-align: right;">5.46</td>
<td style="text-align: right;">5.70</td>
<td style="text-align: left;">▁▅▇▅▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">Fill Ounces</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">23.97</td>
<td style="text-align: right;">0.09</td>
<td style="text-align: right;">23.63</td>
<td style="text-align: right;">23.92</td>
<td style="text-align: right;">23.97</td>
<td style="text-align: right;">24.03</td>
<td style="text-align: right;">24.32</td>
<td style="text-align: left;">▁▃▇▂▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PC Volume</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.28</td>
<td style="text-align: right;">0.06</td>
<td style="text-align: right;">0.09</td>
<td style="text-align: right;">0.24</td>
<td style="text-align: right;">0.27</td>
<td style="text-align: right;">0.31</td>
<td style="text-align: right;">0.47</td>
<td style="text-align: left;">▁▃▇▃▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">Carb Pressure</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">68.31</td>
<td style="text-align: right;">3.55</td>
<td style="text-align: right;">57.00</td>
<td style="text-align: right;">65.80</td>
<td style="text-align: right;">68.20</td>
<td style="text-align: right;">70.60</td>
<td style="text-align: right;">79.40</td>
<td style="text-align: left;">▁▅▇▃▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Carb Temp</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">141.16</td>
<td style="text-align: right;">4.12</td>
<td style="text-align: right;">128.60</td>
<td style="text-align: right;">138.40</td>
<td style="text-align: right;">140.80</td>
<td style="text-align: right;">143.80</td>
<td style="text-align: right;">154.00</td>
<td style="text-align: left;">▁▃▇▃▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">PSC</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.08</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">0.08</td>
<td style="text-align: right;">0.11</td>
<td style="text-align: right;">0.27</td>
<td style="text-align: left;">▆▇▃▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PSC Fill</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.20</td>
<td style="text-align: right;">0.12</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.10</td>
<td style="text-align: right;">0.18</td>
<td style="text-align: right;">0.26</td>
<td style="text-align: right;">0.62</td>
<td style="text-align: left;">▆▇▃▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">PSC CO2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.06</td>
<td style="text-align: right;">0.04</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">0.04</td>
<td style="text-align: right;">0.08</td>
<td style="text-align: right;">0.24</td>
<td style="text-align: left;">▇▅▂▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Mnf Flow</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">24.45</td>
<td style="text-align: right;">119.73</td>
<td style="text-align: right;">-100.20</td>
<td style="text-align: right;">-100.00</td>
<td style="text-align: right;">65.20</td>
<td style="text-align: right;">141.20</td>
<td style="text-align: right;">216.20</td>
<td style="text-align: left;">▇▁▁▆▂</td>
</tr>
<tr class="even">
<td style="text-align: left;">Carb Pressure1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">122.52</td>
<td style="text-align: right;">4.74</td>
<td style="text-align: right;">105.60</td>
<td style="text-align: right;">118.80</td>
<td style="text-align: right;">123.20</td>
<td style="text-align: right;">125.40</td>
<td style="text-align: right;">140.20</td>
<td style="text-align: left;">▁▃▇▂▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Fill Pressure</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">47.88</td>
<td style="text-align: right;">3.17</td>
<td style="text-align: right;">34.60</td>
<td style="text-align: right;">46.00</td>
<td style="text-align: right;">46.40</td>
<td style="text-align: right;">50.00</td>
<td style="text-align: right;">60.40</td>
<td style="text-align: left;">▁▁▇▂▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">Hyd Pressure3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">20.44</td>
<td style="text-align: right;">15.97</td>
<td style="text-align: right;">-1.20</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">27.40</td>
<td style="text-align: right;">33.20</td>
<td style="text-align: right;">50.00</td>
<td style="text-align: left;">▇▁▃▇▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Filler Speed</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3643.07</td>
<td style="text-align: right;">835.39</td>
<td style="text-align: right;">998.00</td>
<td style="text-align: right;">3866.00</td>
<td style="text-align: right;">3982.00</td>
<td style="text-align: right;">3998.00</td>
<td style="text-align: right;">4030.00</td>
<td style="text-align: left;">▁▁▁▁▇</td>
</tr>
<tr class="even">
<td style="text-align: left;">Temperature</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">65.92</td>
<td style="text-align: right;">1.35</td>
<td style="text-align: right;">63.60</td>
<td style="text-align: right;">65.20</td>
<td style="text-align: right;">65.60</td>
<td style="text-align: right;">66.40</td>
<td style="text-align: right;">76.20</td>
<td style="text-align: left;">▇▃▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Usage cont</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">21.00</td>
<td style="text-align: right;">2.97</td>
<td style="text-align: right;">12.08</td>
<td style="text-align: right;">18.39</td>
<td style="text-align: right;">21.80</td>
<td style="text-align: right;">23.76</td>
<td style="text-align: right;">25.90</td>
<td style="text-align: left;">▁▃▅▃▇</td>
</tr>
<tr class="even">
<td style="text-align: left;">Density</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.18</td>
<td style="text-align: right;">0.38</td>
<td style="text-align: right;">0.24</td>
<td style="text-align: right;">0.90</td>
<td style="text-align: right;">0.98</td>
<td style="text-align: right;">1.64</td>
<td style="text-align: right;">1.92</td>
<td style="text-align: left;">▁▅▇▂▆</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Balling</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.22</td>
<td style="text-align: right;">0.94</td>
<td style="text-align: right;">-0.17</td>
<td style="text-align: right;">1.50</td>
<td style="text-align: right;">1.65</td>
<td style="text-align: right;">3.34</td>
<td style="text-align: right;">4.01</td>
<td style="text-align: left;">▁▇▇▂▇</td>
</tr>
<tr class="even">
<td style="text-align: left;">Pressure Vacuum</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-5.21</td>
<td style="text-align: right;">0.57</td>
<td style="text-align: right;">-6.60</td>
<td style="text-align: right;">-5.60</td>
<td style="text-align: right;">-5.40</td>
<td style="text-align: right;">-5.00</td>
<td style="text-align: right;">-3.60</td>
<td style="text-align: left;">▂▇▆▂▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PH</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">8.55</td>
<td style="text-align: right;">0.17</td>
<td style="text-align: right;">7.88</td>
<td style="text-align: right;">8.44</td>
<td style="text-align: right;">8.54</td>
<td style="text-align: right;">8.68</td>
<td style="text-align: right;">9.36</td>
<td style="text-align: left;">▁▅▇▂▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">Oxygen Filler</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">0.06</td>
<td style="text-align: right;">0.40</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Bowl Setpoint</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">109.16</td>
<td style="text-align: right;">15.37</td>
<td style="text-align: right;">70.00</td>
<td style="text-align: right;">100.00</td>
<td style="text-align: right;">120.00</td>
<td style="text-align: right;">120.00</td>
<td style="text-align: right;">140.00</td>
<td style="text-align: left;">▁▂▃▇▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">Pressure Setpoint</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">47.60</td>
<td style="text-align: right;">2.03</td>
<td style="text-align: right;">44.00</td>
<td style="text-align: right;">46.00</td>
<td style="text-align: right;">46.00</td>
<td style="text-align: right;">50.00</td>
<td style="text-align: right;">52.00</td>
<td style="text-align: left;">▁▇▁▆▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Alch Rel</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">6.91</td>
<td style="text-align: right;">0.51</td>
<td style="text-align: right;">6.24</td>
<td style="text-align: right;">6.54</td>
<td style="text-align: right;">6.58</td>
<td style="text-align: right;">7.62</td>
<td style="text-align: right;">8.56</td>
<td style="text-align: left;">▇▁▁▃▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">Carb Rel</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5.44</td>
<td style="text-align: right;">0.13</td>
<td style="text-align: right;">4.96</td>
<td style="text-align: right;">5.34</td>
<td style="text-align: right;">5.40</td>
<td style="text-align: right;">5.56</td>
<td style="text-align: right;">6.06</td>
<td style="text-align: left;">▁▇▇▂▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Balling Lvl</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.08</td>
<td style="text-align: right;">0.88</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">1.38</td>
<td style="text-align: right;">1.48</td>
<td style="text-align: right;">3.16</td>
<td style="text-align: right;">3.66</td>
<td style="text-align: left;">▁▇▂▁▆</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>StudentEvaluation <span class="sc">|&gt;</span> <span class="fu">skim</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Data summary</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">Name</td>
<td style="text-align: left;">StudentEvaluation</td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of rows</td>
<td style="text-align: left;">267</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of columns</td>
<td style="text-align: left;">33</td>
</tr>
<tr class="even">
<td style="text-align: left;">_______________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Column type frequency:</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">character</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">logical</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">31</td>
</tr>
<tr class="odd">
<td style="text-align: left;">________________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Group variables</td>
<td style="text-align: left;">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 19%">
<col style="width: 13%">
<col style="width: 19%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 8%">
<col style="width: 12%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">min</th>
<th style="text-align: right;">max</th>
<th style="text-align: right;">empty</th>
<th style="text-align: right;">n_unique</th>
<th style="text-align: right;">whitespace</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Brand Code</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">0.97</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: logical</strong></p>
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: left;">count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">PH</td>
<td style="text-align: right;">267</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">NaN</td>
<td style="text-align: left;">:</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 17%">
<col style="width: 9%">
<col style="width: 13%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">p0</th>
<th style="text-align: right;">p25</th>
<th style="text-align: right;">p50</th>
<th style="text-align: right;">p75</th>
<th style="text-align: right;">p100</th>
<th style="text-align: left;">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Carb Volume</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5.37</td>
<td style="text-align: right;">0.11</td>
<td style="text-align: right;">5.15</td>
<td style="text-align: right;">5.28</td>
<td style="text-align: right;">5.34</td>
<td style="text-align: right;">5.46</td>
<td style="text-align: right;">5.67</td>
<td style="text-align: left;">▂▇▃▅▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">Fill Ounces</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">23.97</td>
<td style="text-align: right;">0.08</td>
<td style="text-align: right;">23.75</td>
<td style="text-align: right;">23.92</td>
<td style="text-align: right;">23.97</td>
<td style="text-align: right;">24.01</td>
<td style="text-align: right;">24.20</td>
<td style="text-align: left;">▁▅▇▃▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PC Volume</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.28</td>
<td style="text-align: right;">0.06</td>
<td style="text-align: right;">0.10</td>
<td style="text-align: right;">0.23</td>
<td style="text-align: right;">0.28</td>
<td style="text-align: right;">0.32</td>
<td style="text-align: right;">0.46</td>
<td style="text-align: left;">▁▆▇▅▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">Carb Pressure</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">68.25</td>
<td style="text-align: right;">3.86</td>
<td style="text-align: right;">60.20</td>
<td style="text-align: right;">65.30</td>
<td style="text-align: right;">68.00</td>
<td style="text-align: right;">70.60</td>
<td style="text-align: right;">77.60</td>
<td style="text-align: left;">▃▆▇▃▂</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Carb Temp</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">141.27</td>
<td style="text-align: right;">4.36</td>
<td style="text-align: right;">130.00</td>
<td style="text-align: right;">138.40</td>
<td style="text-align: right;">140.80</td>
<td style="text-align: right;">143.90</td>
<td style="text-align: right;">154.00</td>
<td style="text-align: left;">▁▆▇▃▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">PSC</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.09</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">0.08</td>
<td style="text-align: right;">0.11</td>
<td style="text-align: right;">0.25</td>
<td style="text-align: left;">▆▇▃▂▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PSC Fill</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.19</td>
<td style="text-align: right;">0.11</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">0.11</td>
<td style="text-align: right;">0.18</td>
<td style="text-align: right;">0.26</td>
<td style="text-align: right;">0.62</td>
<td style="text-align: left;">▆▇▃▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">PSC CO2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">0.04</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">0.04</td>
<td style="text-align: right;">0.06</td>
<td style="text-align: right;">0.24</td>
<td style="text-align: left;">▇▃▂▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Mnf Flow</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">21.03</td>
<td style="text-align: right;">117.76</td>
<td style="text-align: right;">-100.20</td>
<td style="text-align: right;">-100.00</td>
<td style="text-align: right;">0.20</td>
<td style="text-align: right;">141.30</td>
<td style="text-align: right;">220.40</td>
<td style="text-align: left;">▇▁▁▆▂</td>
</tr>
<tr class="even">
<td style="text-align: left;">Carb Pressure1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">122.98</td>
<td style="text-align: right;">4.44</td>
<td style="text-align: right;">113.00</td>
<td style="text-align: right;">119.90</td>
<td style="text-align: right;">123.40</td>
<td style="text-align: right;">125.50</td>
<td style="text-align: right;">136.00</td>
<td style="text-align: left;">▃▃▇▂▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Fill Pressure</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">48.16</td>
<td style="text-align: right;">3.54</td>
<td style="text-align: right;">37.80</td>
<td style="text-align: right;">46.00</td>
<td style="text-align: right;">47.80</td>
<td style="text-align: right;">50.20</td>
<td style="text-align: right;">60.20</td>
<td style="text-align: left;">▁▇▇▂▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">Hyd Pressure1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">12.01</td>
<td style="text-align: right;">13.53</td>
<td style="text-align: right;">-50.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">10.40</td>
<td style="text-align: right;">20.40</td>
<td style="text-align: right;">50.00</td>
<td style="text-align: left;">▁▁▇▆▂</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Hyd Pressure2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">20.04</td>
<td style="text-align: right;">17.23</td>
<td style="text-align: right;">-50.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">26.80</td>
<td style="text-align: right;">34.80</td>
<td style="text-align: right;">61.40</td>
<td style="text-align: left;">▁▁▆▇▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">Hyd Pressure3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">19.54</td>
<td style="text-align: right;">16.57</td>
<td style="text-align: right;">-50.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">27.60</td>
<td style="text-align: right;">33.00</td>
<td style="text-align: right;">49.20</td>
<td style="text-align: left;">▁▁▆▃▇</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Hyd Pressure4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">98.24</td>
<td style="text-align: right;">14.20</td>
<td style="text-align: right;">68.00</td>
<td style="text-align: right;">90.00</td>
<td style="text-align: right;">98.00</td>
<td style="text-align: right;">104.00</td>
<td style="text-align: right;">140.00</td>
<td style="text-align: left;">▅▆▇▃▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">Filler Level</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">110.14</td>
<td style="text-align: right;">15.64</td>
<td style="text-align: right;">69.20</td>
<td style="text-align: right;">100.60</td>
<td style="text-align: right;">118.40</td>
<td style="text-align: right;">120.20</td>
<td style="text-align: right;">153.20</td>
<td style="text-align: left;">▂▃▇▇▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Filler Speed</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3511.25</td>
<td style="text-align: right;">977.16</td>
<td style="text-align: right;">1006.00</td>
<td style="text-align: right;">3795.00</td>
<td style="text-align: right;">3918.00</td>
<td style="text-align: right;">3996.00</td>
<td style="text-align: right;">4020.00</td>
<td style="text-align: left;">▂▁▁▁▇</td>
</tr>
<tr class="even">
<td style="text-align: left;">Temperature</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">66.24</td>
<td style="text-align: right;">1.70</td>
<td style="text-align: right;">63.80</td>
<td style="text-align: right;">65.40</td>
<td style="text-align: right;">65.80</td>
<td style="text-align: right;">66.60</td>
<td style="text-align: right;">75.40</td>
<td style="text-align: left;">▇▅▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Usage cont</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">20.88</td>
<td style="text-align: right;">3.02</td>
<td style="text-align: right;">12.90</td>
<td style="text-align: right;">18.10</td>
<td style="text-align: right;">21.44</td>
<td style="text-align: right;">23.74</td>
<td style="text-align: right;">24.60</td>
<td style="text-align: left;">▁▂▃▃▇</td>
</tr>
<tr class="even">
<td style="text-align: left;">Carb Flow</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2408.64</td>
<td style="text-align: right;">1161.36</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">1083.00</td>
<td style="text-align: right;">3038.00</td>
<td style="text-align: right;">3215.00</td>
<td style="text-align: right;">3858.00</td>
<td style="text-align: left;">▂▃▁▆▇</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Density</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.18</td>
<td style="text-align: right;">0.38</td>
<td style="text-align: right;">0.06</td>
<td style="text-align: right;">0.92</td>
<td style="text-align: right;">0.98</td>
<td style="text-align: right;">1.60</td>
<td style="text-align: right;">1.84</td>
<td style="text-align: left;">▁▁▇▁▅</td>
</tr>
<tr class="even">
<td style="text-align: left;">MFR</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">652.71</td>
<td style="text-align: right;">168.27</td>
<td style="text-align: right;">15.60</td>
<td style="text-align: right;">687.20</td>
<td style="text-align: right;">720.40</td>
<td style="text-align: right;">730.70</td>
<td style="text-align: right;">784.80</td>
<td style="text-align: left;">▁▁▁▁▇</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Balling</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.20</td>
<td style="text-align: right;">0.93</td>
<td style="text-align: right;">0.90</td>
<td style="text-align: right;">1.50</td>
<td style="text-align: right;">1.65</td>
<td style="text-align: right;">3.24</td>
<td style="text-align: right;">3.79</td>
<td style="text-align: left;">▅▇▁▂▅</td>
</tr>
<tr class="even">
<td style="text-align: left;">Pressure Vacuum</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-5.18</td>
<td style="text-align: right;">0.58</td>
<td style="text-align: right;">-6.40</td>
<td style="text-align: right;">-5.60</td>
<td style="text-align: right;">-5.20</td>
<td style="text-align: right;">-4.80</td>
<td style="text-align: right;">-3.60</td>
<td style="text-align: left;">▁▇▆▃▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Oxygen Filler</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">0.06</td>
<td style="text-align: right;">0.40</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">Bowl Setpoint</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">109.51</td>
<td style="text-align: right;">15.10</td>
<td style="text-align: right;">70.00</td>
<td style="text-align: right;">100.00</td>
<td style="text-align: right;">120.00</td>
<td style="text-align: right;">120.00</td>
<td style="text-align: right;">130.00</td>
<td style="text-align: left;">▂▂▁▃▇</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Pressure Setpoint</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">47.73</td>
<td style="text-align: right;">2.07</td>
<td style="text-align: right;">44.00</td>
<td style="text-align: right;">46.00</td>
<td style="text-align: right;">46.00</td>
<td style="text-align: right;">50.00</td>
<td style="text-align: right;">52.00</td>
<td style="text-align: left;">▁▇▁▇▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">Air Pressurer</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">142.83</td>
<td style="text-align: right;">1.23</td>
<td style="text-align: right;">141.20</td>
<td style="text-align: right;">142.20</td>
<td style="text-align: right;">142.60</td>
<td style="text-align: right;">142.80</td>
<td style="text-align: right;">147.20</td>
<td style="text-align: left;">▅▇▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Alch Rel</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">6.90</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">6.40</td>
<td style="text-align: right;">6.54</td>
<td style="text-align: right;">6.58</td>
<td style="text-align: right;">7.18</td>
<td style="text-align: right;">7.82</td>
<td style="text-align: left;">▇▁▂▁▃</td>
</tr>
<tr class="even">
<td style="text-align: left;">Carb Rel</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5.44</td>
<td style="text-align: right;">0.13</td>
<td style="text-align: right;">5.18</td>
<td style="text-align: right;">5.34</td>
<td style="text-align: right;">5.40</td>
<td style="text-align: right;">5.56</td>
<td style="text-align: right;">5.74</td>
<td style="text-align: left;">▂▇▃▃▂</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Balling Lvl</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.05</td>
<td style="text-align: right;">0.88</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">1.38</td>
<td style="text-align: right;">1.48</td>
<td style="text-align: right;">3.08</td>
<td style="text-align: right;">3.42</td>
<td style="text-align: left;">▁▃▇▁▇</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Below, we will perform exploratory data analysis (EDA) to understand the dataset better. We will summarize the data, visualize distributions, and check for missing values. We will also explore relationships between predictors and the response variable (pH).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary statistics</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(StudentData)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Carb Volume     Fill Ounces      PC Volume       Carb Pressure  
 Min.   :5.040   Min.   :23.63   Min.   :0.08667   Min.   :57.00  
 1st Qu.:5.293   1st Qu.:23.92   1st Qu.:0.23933   1st Qu.:65.80  
 Median :5.347   Median :23.97   Median :0.27133   Median :68.20  
 Mean   :5.374   Mean   :23.97   Mean   :0.27707   Mean   :68.31  
 3rd Qu.:5.460   3rd Qu.:24.03   3rd Qu.:0.31100   3rd Qu.:70.60  
 Max.   :5.700   Max.   :24.32   Max.   :0.47067   Max.   :79.40  
   Carb Temp          PSC             PSC Fill         PSC CO2      
 Min.   :128.6   Min.   :0.00200   Min.   :0.0000   Min.   :0.0000  
 1st Qu.:138.4   1st Qu.:0.04800   1st Qu.:0.1000   1st Qu.:0.0200  
 Median :140.8   Median :0.07800   Median :0.1800   Median :0.0400  
 Mean   :141.2   Mean   :0.08463   Mean   :0.1962   Mean   :0.0566  
 3rd Qu.:143.8   3rd Qu.:0.11200   3rd Qu.:0.2600   3rd Qu.:0.0800  
 Max.   :154.0   Max.   :0.27000   Max.   :0.6200   Max.   :0.2400  
    Mnf Flow       Carb Pressure1  Fill Pressure   Hyd Pressure3  
 Min.   :-100.20   Min.   :105.6   Min.   :34.60   Min.   :-1.20  
 1st Qu.:-100.00   1st Qu.:118.8   1st Qu.:46.00   1st Qu.: 0.00  
 Median :  65.20   Median :123.2   Median :46.40   Median :27.40  
 Mean   :  24.45   Mean   :122.5   Mean   :47.88   Mean   :20.44  
 3rd Qu.: 141.20   3rd Qu.:125.4   3rd Qu.:50.00   3rd Qu.:33.20  
 Max.   : 216.20   Max.   :140.2   Max.   :60.40   Max.   :50.00  
  Filler Speed   Temperature      Usage cont       Density     
 Min.   : 998   Min.   :63.60   Min.   :12.08   Min.   :0.240  
 1st Qu.:3866   1st Qu.:65.20   1st Qu.:18.39   1st Qu.:0.900  
 Median :3982   Median :65.60   Median :21.80   Median :0.980  
 Mean   :3643   Mean   :65.92   Mean   :21.00   Mean   :1.184  
 3rd Qu.:3998   3rd Qu.:66.40   3rd Qu.:23.76   3rd Qu.:1.640  
 Max.   :4030   Max.   :76.20   Max.   :25.90   Max.   :1.920  
    Balling       Pressure Vacuum       PH        Oxygen Filler    
 Min.   :-0.170   Min.   :-6.60   Min.   :7.880   Min.   :0.00240  
 1st Qu.: 1.496   1st Qu.:-5.60   1st Qu.:8.440   1st Qu.:0.02200  
 Median : 1.648   Median :-5.40   Median :8.540   Median :0.03340  
 Mean   : 2.223   Mean   :-5.21   Mean   :8.548   Mean   :0.04692  
 3rd Qu.: 3.340   3rd Qu.:-5.00   3rd Qu.:8.680   3rd Qu.:0.06000  
 Max.   : 4.012   Max.   :-3.60   Max.   :9.360   Max.   :0.40000  
 Bowl Setpoint   Pressure Setpoint    Alch Rel        Carb Rel    
 Min.   : 70.0   Min.   :44.0      Min.   :6.240   Min.   :4.960  
 1st Qu.:100.0   1st Qu.:46.0      1st Qu.:6.540   1st Qu.:5.340  
 Median :120.0   Median :46.0      Median :6.580   Median :5.400  
 Mean   :109.2   Mean   :47.6      Mean   :6.909   Mean   :5.441  
 3rd Qu.:120.0   3rd Qu.:50.0      3rd Qu.:7.620   3rd Qu.:5.560  
 Max.   :140.0   Max.   :52.0      Max.   :8.560   Max.   :6.060  
  Balling Lvl   
 Min.   :0.000  
 1st Qu.:1.380  
 Median :1.480  
 Mean   :2.078  
 3rd Qu.:3.160  
 Max.   :3.660  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Histograms</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_histogram</span>(StudentData)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Technical_Report_files/figure-html/eda-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Technical_Report_files/figure-html/eda-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize missing data</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>StudentData <span class="sc">|&gt;</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), <span class="sc">~</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(.)))) <span class="sc">|&gt;</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="fu">everything</span>()) <span class="sc">|&gt;</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(value <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">|&gt;</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(value))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 0 × 2
# ℹ 2 variables: name &lt;chr&gt;, value &lt;int&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot missing data</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_missing</span>(StudentData)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Technical_Report_files/figure-html/eda-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Correlation matrix</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>correlation_matrix <span class="ot">&lt;-</span> StudentData <span class="sc">|&gt;</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="fu">where</span>(is.numeric)) <span class="sc">|&gt;</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cor</span>(<span class="at">use =</span> <span class="st">"pairwise.complete.obs"</span>)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>    correlation_matrix,</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">order =</span> <span class="st">"hclust"</span>,</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># addCoef.col = "grey",</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># addCoefasPercent = TRUE,</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">tl.cex =</span> <span class="fl">0.7</span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Technical_Report_files/figure-html/eda-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Feature plot</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">featurePlot</span>(</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> StudentData <span class="sc">|&gt;</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">select</span>(<span class="fu">where</span>(is.numeric)) <span class="sc">|&gt;</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">select</span>(<span class="sc">-</span>PH),</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> StudentData<span class="sc">$</span>PH,</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot =</span> <span class="st">"scatter"</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Technical_Report_files/figure-html/eda-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>From the visualizations and summary statistics above, we can observe:</p>
<ol type="1">
<li>Distribution patterns:
<ul>
<li>Some variables show some skewness, e.g., <code>Filler.Speed</code>, <code>MFR</code>, <code>Oxygen.Filler</code>, and <code>Usage.cont</code></li>
<li>Many variables are bimodal, e.g., <code>Air.Pressurer</code>, <code>Balling</code>, <code>Balling.Lvl</code>, <code>Carb.Flow</code>, <code>Carb.Rel</code>, and <code>Density</code></li>
<li>The target variable <code>PH</code> has a relatively normal distribution</li>
</ul></li>
<li>Correlations:
<ul>
<li>Several predictors show moderate correlations with <code>PH</code>, e.g., <code>Mnf Flow</code>, <code>Usage cont</code>, <code>Filler Level</code>, <code>Bowl Setpoint</code>, and <code>Pressure Setpoint</code></li>
<li>There are some strong correlations between predictors, suggesting potential multicollinearity. We should address multicollinearity in the data cleaning phase</li>
</ul></li>
<li>Missing values:
<ul>
<li>Several variables contain missing values that will need to be addressed, especially <code>MFR</code></li>
</ul></li>
</ol>
</section>
<section id="forecast" class="level2">
<h2 class="anchored" data-anchor-id="forecast">Forecast</h2>
<p>We will try the following models:</p>
<ul>
<li>Linear regression models:
<ul>
<li>PLS</li>
<li>Elastic Net</li>
</ul></li>
<li>Non-linear regression models:
<ul>
<li>KNN</li>
<li>Multivariate Adaptive Regression Splines (MARS)</li>
</ul></li>
<li>Tree-based regression models:
<ul>
<li>Single Tree</li>
<li>Model Tree</li>
</ul></li>
</ul>
<p>Since the data is relatively large, we will avoid heavy models like neural networks, support vector machines (SVM), or boosted trees. Since we have a lot of predictors, we opt for models that handle feature selection or dimensionality reduction like elastic net, PLS, and tree-based models. We also want model results to be easy to interpret for our non-technical report, so we focus on elastic net, MARS, and single/model trees.</p>
<p>Also, because the data is relatively large, we can afford to use a training and a test set. We also center and scale the data to ensure that all predictors are on the same scale, which is important for models like PLS and elastic net.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># &lt;!--NB to DELETE this line after imputation section is completed--&gt;</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>StudentData <span class="ot">&lt;-</span> StudentData <span class="sc">|&gt;</span> <span class="fu">drop_na</span>()</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Split the data into a training and a test set</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>trainingRows <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>    StudentData<span class="sc">$</span>PH,</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">p =</span> .<span class="dv">80</span>,</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">list =</span> <span class="cn">FALSE</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>StudentData_train <span class="ot">&lt;-</span> StudentData[trainingRows, ]</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>StudentData_test <span class="ot">&lt;-</span> StudentData[<span class="sc">-</span>trainingRows, ]</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Save training and test predictors and response variables</span></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>StudentData_train_x <span class="ot">&lt;-</span> StudentData_train[, <span class="sc">!</span><span class="fu">names</span>(StudentData_train) <span class="sc">%in%</span> <span class="st">"PH"</span>]</span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>StudentData_train_y <span class="ot">&lt;-</span> StudentData_train<span class="sc">$</span>PH</span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>StudentData_test_x <span class="ot">&lt;-</span> StudentData_test[, <span class="sc">!</span><span class="fu">names</span>(StudentData_test) <span class="sc">%in%</span> <span class="st">"PH"</span>]</span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>StudentData_test_y <span class="ot">&lt;-</span> StudentData_test<span class="sc">$</span>PH</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Fitting models to the training data below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pre-process the data and tune a PLS model</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>ctrl <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">number =</span> <span class="dv">10</span>)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Train</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>plsTune <span class="ot">&lt;-</span> <span class="fu">train</span>(</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>    StudentData_train_x,</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>    StudentData_train_y,</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"pls"</span>,</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">tuneLength =</span> <span class="dv">20</span>,</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">trControl =</span> ctrl,</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">preProc =</span> <span class="fu">c</span>(<span class="st">"center"</span>, <span class="st">"scale"</span>)</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>plsTune</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Partial Least Squares 

1962 samples
  24 predictor

Pre-processing: centered (24), scaled (24) 
Resampling: Cross-Validated (10 fold) 
Summary of sample sizes: 1766, 1766, 1765, 1765, 1765, 1767, ... 
Resampling results across tuning parameters:

  ncomp  RMSE       Rsquared   MAE      
   1     0.1526797  0.2079136  0.1218203
   2     0.1471535  0.2643367  0.1159609
   3     0.1432137  0.3034941  0.1124250
   4     0.1412104  0.3226412  0.1107318
   5     0.1400134  0.3350179  0.1090715
   6     0.1394261  0.3404217  0.1084824
   7     0.1392301  0.3424078  0.1080465
   8     0.1390773  0.3438246  0.1077497
   9     0.1390288  0.3443471  0.1075500
  10     0.1388862  0.3457525  0.1074372
  11     0.1389129  0.3454862  0.1074918
  12     0.1389022  0.3456613  0.1074216
  13     0.1388885  0.3456497  0.1074181
  14     0.1388843  0.3456261  0.1073457
  15     0.1388608  0.3458722  0.1074054
  16     0.1388164  0.3462472  0.1073657
  17     0.1388035  0.3463532  0.1073653
  18     0.1388021  0.3463435  0.1073626
  19     0.1387940  0.3464281  0.1073501
  20     0.1387949  0.3464369  0.1073789

RMSE was used to select the optimal model using the smallest value.
The final value used for the model was ncomp = 19.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>plsPred <span class="ot">&lt;-</span> <span class="fu">predict</span>(</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>    plsTune,</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">newdata =</span> StudentData_test_x</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Train</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>enetGrid <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">.lambda =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.01</span>, .<span class="dv">1</span>),</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">.fraction =</span> <span class="fu">seq</span>(.<span class="dv">05</span>, <span class="dv">1</span>, <span class="at">length =</span> <span class="dv">20</span>)</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>enetTune <span class="ot">&lt;-</span> <span class="fu">train</span>(</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>    StudentData_train_x,</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>    StudentData_train_y,</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"enet"</span>,</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">tuneGrid =</span> enetGrid,</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">trControl =</span> ctrl,</span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">preProc =</span> <span class="fu">c</span>(<span class="st">"center"</span>, <span class="st">"scale"</span>)</span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>enetTune</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Elasticnet 

1962 samples
  24 predictor

Pre-processing: centered (24), scaled (24) 
Resampling: Cross-Validated (10 fold) 
Summary of sample sizes: 1766, 1765, 1766, 1765, 1766, 1766, ... 
Resampling results across tuning parameters:

  lambda  fraction  RMSE       Rsquared   MAE      
  0.00    0.05      0.1601345  0.2011441  0.1284125
  0.00    0.10      0.1540732  0.2304001  0.1228536
  0.00    0.15      0.1498289  0.2590501  0.1191415
  0.00    0.20      0.1468450  0.2838702  0.1165682
  0.00    0.25      0.1448653  0.2972581  0.1147845
  0.00    0.30      0.1435667  0.3077049  0.1135107
  0.00    0.35      0.1425359  0.3161448  0.1123879
  0.00    0.40      0.1417207  0.3234398  0.1114343
  0.00    0.45      0.1409846  0.3301680  0.1105673
  0.00    0.50      0.1403838  0.3354294  0.1098225
  0.00    0.55      0.1398682  0.3399829  0.1092024
  0.00    0.60      0.1394399  0.3436469  0.1086864
  0.00    0.65      0.1391420  0.3460973  0.1083083
  0.00    0.70      0.1389659  0.3474658  0.1080736
  0.00    0.75      0.1388727  0.3482473  0.1078942
  0.00    0.80      0.1388056  0.3488704  0.1077619
  0.00    0.85      0.1387864  0.3490144  0.1077112
  0.00    0.90      0.1387763  0.3491760  0.1076575
  0.00    0.95      0.1387886  0.3491727  0.1076234
  0.00    1.00      0.1388106  0.3490656  0.1076050
  0.01    0.05      0.1617007  0.2011441  0.1298980
  0.01    0.10      0.1559350  0.2149989  0.1245400
  0.01    0.15      0.1518210  0.2469449  0.1209467
  0.01    0.20      0.1488597  0.2667107  0.1183130
  0.01    0.25      0.1465223  0.2860583  0.1162839
  0.01    0.30      0.1449236  0.2966215  0.1148444
  0.01    0.35      0.1438352  0.3051499  0.1137895
  0.01    0.40      0.1428989  0.3128900  0.1128085
  0.01    0.45      0.1421794  0.3190104  0.1119786
  0.01    0.50      0.1415173  0.3251614  0.1112250
  0.01    0.55      0.1409323  0.3304411  0.1105405
  0.01    0.60      0.1404313  0.3349041  0.1099482
  0.01    0.65      0.1399883  0.3388411  0.1094341
  0.01    0.70      0.1396048  0.3421459  0.1089730
  0.01    0.75      0.1393141  0.3445714  0.1085895
  0.01    0.80      0.1391150  0.3461814  0.1083140
  0.01    0.85      0.1389928  0.3471577  0.1081191
  0.01    0.90      0.1389196  0.3478156  0.1079606
  0.01    0.95      0.1388722  0.3482623  0.1078498
  0.01    1.00      0.1388606  0.3484105  0.1077897
  0.10    0.05      0.1638558  0.2011441  0.1318334
  0.10    0.10      0.1585045  0.2018874  0.1269724
  0.10    0.15      0.1550239  0.2242135  0.1236834
  0.10    0.20      0.1519755  0.2470133  0.1211153
  0.10    0.25      0.1496545  0.2599766  0.1190500
  0.10    0.30      0.1478429  0.2729046  0.1174944
  0.10    0.35      0.1462711  0.2853873  0.1161148
  0.10    0.40      0.1451180  0.2932649  0.1150831
  0.10    0.45      0.1442514  0.2994607  0.1142692
  0.10    0.50      0.1435818  0.3047478  0.1135673
  0.10    0.55      0.1429640  0.3101439  0.1129273
  0.10    0.60      0.1424990  0.3143893  0.1123999
  0.10    0.65      0.1420278  0.3188406  0.1119117
  0.10    0.70      0.1415896  0.3230027  0.1114634
  0.10    0.75      0.1411906  0.3267758  0.1110571
  0.10    0.80      0.1408349  0.3301034  0.1106788
  0.10    0.85      0.1405335  0.3328807  0.1103409
  0.10    0.90      0.1402906  0.3351267  0.1100298
  0.10    0.95      0.1401088  0.3368171  0.1097744
  0.10    1.00      0.1399705  0.3381808  0.1095556

RMSE was used to select the optimal model using the smallest value.
The final values used for the model were fraction = 0.9 and lambda = 0.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>enetPred <span class="ot">&lt;-</span> <span class="fu">predict</span>(</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>    enetTune,</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">newdata =</span> StudentData_test_x</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Train</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>knnTune <span class="ot">&lt;-</span> <span class="fu">train</span>(</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>    StudentData_train_x,</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>    StudentData_train_y,</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"knn"</span>,</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">preProc =</span> <span class="fu">c</span>(<span class="st">"center"</span>, <span class="st">"scale"</span>),</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">tuneLength =</span> <span class="dv">10</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>knnTune</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>k-Nearest Neighbors 

1962 samples
  24 predictor

Pre-processing: centered (24), scaled (24) 
Resampling: Bootstrapped (25 reps) 
Summary of sample sizes: 1962, 1962, 1962, 1962, 1962, 1962, ... 
Resampling results across tuning parameters:

  k   RMSE       Rsquared   MAE      
   5  0.1468107  0.3140679  0.1105596
   7  0.1422994  0.3351414  0.1081572
   9  0.1408792  0.3401269  0.1074622
  11  0.1400273  0.3435291  0.1071483
  13  0.1394784  0.3461509  0.1069679
  15  0.1390525  0.3488830  0.1067234
  17  0.1389469  0.3490437  0.1067309
  19  0.1392141  0.3460024  0.1068582
  21  0.1394996  0.3428843  0.1072541
  23  0.1396773  0.3411122  0.1076109

RMSE was used to select the optimal model using the smallest value.
The final value used for the model was k = 17.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>knnPred <span class="ot">&lt;-</span> <span class="fu">predict</span>(</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>    knnTune,</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">newdata =</span> StudentData_test_x</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Train</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>marsGrid <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">.degree =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">.nprune =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">38</span>)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>marsTune <span class="ot">&lt;-</span> <span class="fu">train</span>(</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>    StudentData_train_x,</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>    StudentData_train_y,</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"earth"</span>,</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">tuneGrid =</span> marsGrid,</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>)</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>marsTune</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Multivariate Adaptive Regression Spline 

1962 samples
  24 predictor

No pre-processing
Resampling: Cross-Validated (10 fold) 
Summary of sample sizes: 1767, 1765, 1766, 1766, 1766, 1766, ... 
Resampling results across tuning parameters:

  degree  nprune  RMSE       Rsquared   MAE       
  1        2      0.1530554  0.2010966  0.12076882
  1        3      0.1493903  0.2401567  0.11721014
  1        4      0.1475967  0.2583089  0.11508385
  1        5      0.1441135  0.2928586  0.11215113
  1        6      0.1412196  0.3206006  0.11027152
  1        7      0.1396786  0.3354710  0.10841210
  1        8      0.1386492  0.3455783  0.10778889
  1        9      0.1370632  0.3607386  0.10615270
  1       10      0.1359082  0.3710701  0.10498734
  1       11      0.1355545  0.3746400  0.10413011
  1       12      0.1353180  0.3771063  0.10389014
  1       13      0.1349824  0.3799255  0.10323187
  1       14      0.1340983  0.3874558  0.10245107
  1       15      0.1336277  0.3918621  0.10202642
  1       16      0.1330648  0.3970344  0.10153581
  1       17      0.1330605  0.3968803  0.10142027
  1       18      0.1328444  0.3985468  0.10112598
  1       19      0.1328576  0.3984812  0.10116027
  1       20      0.1328576  0.3984812  0.10116027
  1       21      0.1328576  0.3984812  0.10116027
  1       22      0.1328576  0.3984812  0.10116027
  1       23      0.1328576  0.3984812  0.10116027
  1       24      0.1328576  0.3984812  0.10116027
  1       25      0.1328576  0.3984812  0.10116027
  1       26      0.1328576  0.3984812  0.10116027
  1       27      0.1328576  0.3984812  0.10116027
  1       28      0.1328576  0.3984812  0.10116027
  1       29      0.1328576  0.3984812  0.10116027
  1       30      0.1328576  0.3984812  0.10116027
  1       31      0.1328576  0.3984812  0.10116027
  1       32      0.1328576  0.3984812  0.10116027
  1       33      0.1328576  0.3984812  0.10116027
  1       34      0.1328576  0.3984812  0.10116027
  1       35      0.1328576  0.3984812  0.10116027
  1       36      0.1328576  0.3984812  0.10116027
  1       37      0.1328576  0.3984812  0.10116027
  1       38      0.1328576  0.3984812  0.10116027
  2        2      0.1542822  0.1884954  0.12244084
  2        3      0.1514754  0.2177614  0.11981251
  2        4      0.1473989  0.2594755  0.11611644
  2        5      0.1426794  0.3058650  0.11115796
  2        6      0.1401865  0.3298422  0.10917865
  2        7      0.1384874  0.3463073  0.10764161
  2        8      0.1363060  0.3665916  0.10535826
  2        9      0.1352431  0.3769944  0.10439539
  2       10      0.1346738  0.3829790  0.10412362
  2       11      0.1336340  0.3924731  0.10278596
  2       12      0.1328728  0.3994233  0.10183836
  2       13      0.1318672  0.4082812  0.10093042
  2       14      0.1307921  0.4177503  0.10013719
  2       15      0.1298955  0.4254009  0.09936189
  2       16      0.1290102  0.4329946  0.09846298
  2       17      0.1283585  0.4384733  0.09786777
  2       18      0.1279850  0.4419942  0.09761995
  2       19      0.1276791  0.4448898  0.09742010
  2       20      0.1274843  0.4469502  0.09699489
  2       21      0.1270550  0.4505717  0.09632553
  2       22      0.1265251  0.4549605  0.09574636
  2       23      0.1261691  0.4578666  0.09571158
  2       24      0.1261407  0.4583183  0.09567298
  2       25      0.1259032  0.4604620  0.09545430
  2       26      0.1261617  0.4584348  0.09566039
  2       27      0.1263498  0.4570693  0.09573042
  2       28      0.1263794  0.4568212  0.09576941
  2       29      0.1264432  0.4561018  0.09570888
  2       30      0.1264791  0.4558687  0.09574357
  2       31      0.1264791  0.4558687  0.09574357
  2       32      0.1264791  0.4558687  0.09574357
  2       33      0.1264791  0.4558687  0.09574357
  2       34      0.1264791  0.4558687  0.09574357
  2       35      0.1264791  0.4558687  0.09574357
  2       36      0.1264791  0.4558687  0.09574357
  2       37      0.1264791  0.4558687  0.09574357
  2       38      0.1264791  0.4558687  0.09574357

RMSE was used to select the optimal model using the smallest value.
The final values used for the model were nprune = 25 and degree = 2.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>marsPred <span class="ot">&lt;-</span> <span class="fu">predict</span>(</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>    marsTune,</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">newdata =</span> StudentData_test_x</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Train</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>rpartTune <span class="ot">&lt;-</span> <span class="fu">train</span>(</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>    StudentData_train_x,</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>    StudentData_train_y,</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"rpart2"</span>,</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">tuneLength =</span> <span class="dv">10</span>,</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>)</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>rpartTune</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>CART 

1962 samples
  24 predictor

No pre-processing
Resampling: Cross-Validated (10 fold) 
Summary of sample sizes: 1766, 1766, 1766, 1765, 1767, 1765, ... 
Resampling results across tuning parameters:

  maxdepth  RMSE       Rsquared   MAE      
   1        0.1523146  0.2119612  0.1201254
   2        0.1496315  0.2395631  0.1178115
   3        0.1459342  0.2776622  0.1148154
   4        0.1457576  0.2786126  0.1141662
   5        0.1444241  0.2928356  0.1128590
   6        0.1432122  0.3047941  0.1110184
   7        0.1410279  0.3258310  0.1091335
   9        0.1378816  0.3541764  0.1059367
  11        0.1363541  0.3681296  0.1046191
  12        0.1357220  0.3753388  0.1034858

RMSE was used to select the optimal model using the smallest value.
The final value used for the model was maxdepth = 12.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>rpartPred <span class="ot">&lt;-</span> <span class="fu">predict</span>(</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>    rpartTune,</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">newdata =</span> StudentData_test_x</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Train</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>m5Tune <span class="ot">&lt;-</span> <span class="fu">train</span>(</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>    StudentData_train_x,</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>    StudentData_train_y,</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"M5"</span>,</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>),</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">control =</span> <span class="fu">Weka_control</span>(<span class="at">M =</span> <span class="dv">10</span>)</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>m5Tune</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Model Tree 

1962 samples
  24 predictor

No pre-processing
Resampling: Cross-Validated (10 fold) 
Summary of sample sizes: 1766, 1766, 1765, 1766, 1767, 1765, ... 
Resampling results across tuning parameters:

  pruned  smoothed  rules  RMSE       Rsquared    MAE       
  Yes     Yes       Yes    1.2458573  0.05795690  0.68422651
  Yes     Yes       No     1.4010964  0.20315979  1.13293419
  Yes     No        Yes    0.1302646  0.43411860  0.09838884
  Yes     No        No     0.1345841  0.43035628  0.09473805
  No      Yes       Yes    1.2468725  0.05158761  0.68043245
  No      Yes       No     1.4017614  0.20889386  1.13413877
  No      No        Yes    0.1454876  0.35179249  0.10366004
  No      No        No     0.1314663  0.46889584  0.09110417

RMSE was used to select the optimal model using the smallest value.
The final values used for the model were pruned = Yes, smoothed = No and
 rules = Yes.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>m5Pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>    m5Tune,</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">newdata =</span> StudentData_test_x</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="compare-model-fit-and-select-optimal-model" class="level2">
<h2 class="anchored" data-anchor-id="compare-model-fit-and-select-optimal-model">Compare model fit and select optimal model</h2>
<p>Next, we compare fit and pick model to export.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>ranking <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">Model =</span> <span class="fu">c</span>(</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">"PLS"</span>,</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Elastic Net"</span>,</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">"KNN"</span>,</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">"MARS"</span>,</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Single Tree"</span>,</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Model Tree"</span></span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rbind</span>(</span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>        <span class="fu">postResample</span>(<span class="at">pred =</span> plsPred, <span class="at">obs =</span> StudentData_test_y),</span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>        <span class="fu">postResample</span>(<span class="at">pred =</span> enetPred, <span class="at">obs =</span> StudentData_test_y),</span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>        <span class="fu">postResample</span>(<span class="at">pred =</span> knnPred, <span class="at">obs =</span> StudentData_test_y),</span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>        <span class="fu">postResample</span>(<span class="at">pred =</span> marsPred, <span class="at">obs =</span> StudentData_test_y),</span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>        <span class="fu">postResample</span>(<span class="at">pred =</span> rpartPred, <span class="at">obs =</span> StudentData_test_y),</span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a>        <span class="fu">postResample</span>(<span class="at">pred =</span> m5Pred, <span class="at">obs =</span> StudentData_test_y)</span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(RMSE)</span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a>ranking</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Model      RMSE  Rsquared        MAE
1        MARS 0.1272761 0.4648325 0.09312472
2         KNN 0.1345978 0.4043236 0.10111539
3 Single Tree 0.1383991 0.3690571 0.10465582
4         PLS 0.1393725 0.3598857 0.10551285
5 Elastic Net 0.1395623 0.3583227 0.10572661
6  Model Tree 0.1498461 0.3231580 0.10230842</code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>best <span class="ot">&lt;-</span> ranking[<span class="dv">1</span>, <span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>The MARS model gives the optimal resampling and test set performance since it has the lowest RMSE and highest R squared.</strong></p>
</section>
<section id="predict-ph-for-test-set" class="level2">
<h2 class="anchored" data-anchor-id="predict-ph-for-test-set">Predict pH for test set</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict pH for the test set using the best model</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (best <span class="sc">==</span> <span class="st">"PLS"</span>) {</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>    finalTune <span class="ot">&lt;-</span> plsTune</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> <span class="cf">if</span> (best <span class="sc">==</span> <span class="st">"Elastic Net"</span>) {</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>    finalTune <span class="ot">&lt;-</span> enetTune</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> <span class="cf">if</span> (best <span class="sc">==</span> <span class="st">"KNN"</span>) {</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>    finalTune <span class="ot">&lt;-</span> knnTune</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> <span class="cf">if</span> (best <span class="sc">==</span> <span class="st">"MARS"</span>) {</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>    finalTune <span class="ot">&lt;-</span> marsTune</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> <span class="cf">if</span> (best <span class="sc">==</span> <span class="st">"Single Tree"</span>) {</span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>    finalTune <span class="ot">&lt;-</span> rpartTune</span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> <span class="cf">if</span> (best <span class="sc">==</span> <span class="st">"Model Tree"</span>) {</span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>    finalTune <span class="ot">&lt;-</span> m5Tune</span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a>StudentEvaluation_x <span class="ot">&lt;-</span> StudentEvaluation <span class="sc">|&gt;</span></span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>PH) </span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine predictions with the test set</span></span>
<span id="cb62-20"><a href="#cb62-20" aria-hidden="true" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb62-21"><a href="#cb62-21" aria-hidden="true" tabindex="-1"></a>    StudentEvaluation_x,</span>
<span id="cb62-22"><a href="#cb62-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">PH =</span> <span class="fu">predict</span>(finalTune, <span class="at">newdata =</span> StudentEvaluation_x)</span>
<span id="cb62-23"><a href="#cb62-23" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span> </span>
<span id="cb62-24"><a href="#cb62-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">PH =</span> y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="export" class="level2">
<h2 class="anchored" data-anchor-id="export">Export</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Export predictions to Excel</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write.xlsx</span>(predictions, <span class="st">"PH_forecasts.xlsx"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p><strong>The forecasts for PH are saved as “PH_forecasts.xlsx”, using the MARS model.</strong></p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>